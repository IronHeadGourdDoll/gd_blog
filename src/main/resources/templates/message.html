<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:include="common/common_head::commonHeader"></head>
<body>
    <div th:include="common/common_navigation :: commonNavigation"></div>

    <div class="container pt">
        <div class="row mt centered">

            <div class="col-lg-12">
                <!--markdown编辑，留言框-->

                    <form id="message_form">
                        <textarea id="message_textarea" placeholder="快来留言吧"></textarea>
                        <input type="submit" value="留下" onclick="leave_message();">
                    </form>

                <!--留言板显示栏-->
                <div class="" id="message_list">
                    <h5>当前位置：留言板</h5>
                    <ul>
                        <li class="message_art_item" th:each="msg,iterStat : ${messagePage}">
                            <div class="summary" style="width: 80%;">
                                <span th:text="${msg.content}" style=""></span><br>
                                <span th:text="${msg.messagePeople}" style=""></span><br>
                                <span th:text="${msg.createTime}" style=""></span>
                            </div>
                        </li>
                    </ul>
                </div>

                <!--留言板分页栏-->
                <div class="message_page" style="margin-bottom: 50px;">
                    <!-- 分页操作栏 -->
                    <div class="col-md-12">
                        <div class="row">
                            <!--文字信息-->
                            <div class="col-md-6">
                                当前第 [[${messagePage.getNumber()+1}]] 页.总共[[${messagePage.totalPages}]]页.一共 [[${messagePage.totalElements}]]条记录
                            </div>
                            <!--点击分页-->
                            <div class="col-md-6">
                                <nav aria-label="Page navigation">
                                    <ul class="pagination">

                                        <!--首页-->
                                        <li><a th:href="@{'/messagePage?start=0'}">首页</a></li>
                                        <!--上一页-->
                                        <li th:if="${messagePage.hasPrevious()}"><a th:href="@{'/message?start='+${messagePage.number-1}}" aria-label="Previous"><span aria-hidden="true">上一页</span></a></li>
                                        <li th:unless="${messagePage.hasPrevious()}"><a th:href="@{'/message?start=0'}" aria-label="Previous"><span aria-hidden="true">上一页</span></a></li>
                                        <!--下一页-->
                                        <li th:if="${messagePage.hasNext()}"><a th:href="@{'/message?start='+${messagePage.number+1}}" aria-label="Next"><span aria-hidden="true">下一页</span></a></li>
                                        <li th:unless="${messagePage.hasNext()}"><a th:href="@{'/message?start='+${messagePage.totalPages-1}}" aria-label="Next"><span aria-hidden="true">下一页</span></a></li>
                                        <!--尾页-->
                                        <li><a th:href="@{'/message?start='+${messagePage.totalPages-1}}">尾页</a></li>

                                    </ul>
                                </nav>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


    </div>
    <div th:include="common/common_footer :: commonFooter"></div>
</body>

<script th:type="javascript">
    alert("page");
    function leave_message() {
        aas*6
        alert("留言");
        if (!$('#message_form').valid()) {
            alert("留言不能为空");
            return false;
        }
        alert("留言不能为空");
        var url = "/leave_message";
        var username=[[session.user.username]];
        var messagePeople=[[session.visitor.username]];
        var content = tinyMCE.activeEditor.getContent() ;
        $.ajax({
            type: "POST",
            url: url,
            dataType: "text",
            contentType: "application/json;charset=UTF-8",
            data: JSON.stringify({
                "messageId": null,
                "username": username,
                "messagePeople": messagePeople,
                "content": content,
            }),
            success: function () {
                alert("留言成功！");
            },
            error: function () {
                alert("error");
            }
        });

    }
</script>
</html>
